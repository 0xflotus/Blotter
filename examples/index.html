<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <style type="text/css">
      body {
        padding: 20px;
        font-family: Charcoal, sans-serif;
        font-size: 22px;
        line-height: 1.5;
        color: #0d0f17;
      }

      canvas {
        padding: 0;
        margin: 0;
        vertical-align: top;
      }
    </style>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.js"></script>
    <script type="text/javascript" src="../build/blotter.js"></script>
  </head>
    <script>
      $(document).ready(function() {

        var texts = ['To', 'communicate', 'Mars', 'converse', 'spirits', 'report', 'the', 'behaviour', 'of', 'sea', 'monster', 'Describe', 'horoscope', 'haruspicate', 'or', 'scry', 'Observe', 'disease', 'in', 'signatures', 'evoke', 'Biography', 'from', 'wrinkles', 'palm', 'And', 'tragedy', 'fingers', 'release', 'omens', 'By', 'sortilege', 'tea', 'leaves', 'riddle', 'inevitable', 'With', 'playing', 'cards', 'fiddle', 'pentagrams', 'Or', 'barbituric', 'acids', 'dissect', 'Sed', 'tincidunt', 'tempor', 'consectetur.', 'Cras', 'imperdiet', 'suscipit', 'massa,', 'ut', 'malesuada', 'enim', 'sollicitudin', 'in.', 'Nullam', 'cursus,', 'lorem', 'vitae', 'cursus', 'gravida,', 'erat'];

        var styleProperties = {
          family: "Charcoal, sans-serif",
          size: 12,
          paddingTop: 12,
          paddingRight: 17,
          paddingBottom: 12,
          paddingLeft: 17,
          leading: 1.5,
          fill: "#0d0f17"
        };

        var blotterTexts = texts.map(function(text) { return new Blotter.Text(text, styleProperties); });

        var material = new Blotter.BubbleShiftMaterial();

        var blotter = new Blotter(material, {
          texts : blotterTexts
        });


        blotter.on("ready", function () {
          var myScope3 = blotter.forText(blotterTexts[12]);
          myScope3.material.uniforms.uLenseWeight.value = 0.25;
        });


        for (var i = 0; i < blotterTexts.length; i++) {
          var text = blotterTexts[i];
              outputEl = document.createElement("span");
          outputEl.style.display = "inline-block";
          document.body.appendChild(outputEl);
          blotter.forText(text).appendTo(outputEl);
        }


        var myScope = blotter.forText(blotterTexts[4]);
        var startTime = new Date().getTime();
        myScope.on("render", function (frameCount) {
          var time = (new Date().getTime() - startTime) / 1000;
          myScope.material.uniforms.uLenseWeight.value = Math.abs(Math.sin(time));
        });


        var myScope2 = blotter.forText(blotterTexts[1]);
        myScope2.on("mousemove", function (mousePosition) {
          myScope2.material.uniforms.uLenseWeight.value = 0.9;
          myScope2.material.uniforms.uCenterPoint.value = [mousePosition.x, mousePosition.y];
        });

        myScope2.on("mouseleave", function () {
          myScope2.material.uniforms.uCenterPoint.value = [0.5, 0.5];
        });


        _.delay(function() {
          var text = new Blotter.Text("hello world", styleProperties);

          blotter.addTexts(text);

          var newScope = blotter.forText(text);

          var container = document.createElement("div");
          document.body.appendChild(container);

          newScope.appendTo(container);

          blotter.needsUpdate = true;
        }, 8000)

      });
    </script>
  </body>
</html>
