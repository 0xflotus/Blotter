<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <style type="text/css">
      body {
        background: #fff;
        padding: 20px;
        font-family: serif;
        font-size: 64px;
        font-weight: 100;
        line-height: 1.5;
        color: #0d0f17;
      }

      canvas {
        padding: 0;
        margin: 0;
        vertical-align: top;
      }
    </style>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.js"></script>
    <script type="text/javascript" src="./third_party/dat.gui.js"></script>
    <script type="text/javascript" src="../build/blotter.js"></script>
    <script type="text/javascript" src="../build/filters/ghostBlurMaterial.js"></script>
  </head>
  <body>
    <span id="filter-target"></span>
    <script>


      $(document).ready(function() {

        var styleProperties = {
          family: "serif",
          size : 64,
          weight : 100,
          paddingTop : 0,
          paddingLeft : 14,
          paddingRight : 14
        };

        var text = new Blotter.Text("Ghost", styleProperties);

        var material = new Blotter.GhostBlurMaterial();

        var blotter = new Blotter(material, {
          texts : text
        });

        var myScope = blotter.forText(text);

        blotter.on("ready", function () {
          myScope.appendTo(document.getElementById("filter-target"));
        });

        var controls = {
          message : "dat.gui",
          uBlurRadius : material.uniforms.uBlurRadius.value,
          uRotation : material.uniforms.uRotation.value,
          uWidth : material.uniforms.uWidth.value,
          uAmplitude : material.uniforms.uAmplitude.value,
          uVolatility : material.uniforms.uVolatility.value,
          uSmoothing : material.uniforms.uSmoothing.value,
          uGlowColor : "#000000"
        };

        var gui = new dat.GUI();

        gui.add(controls, "uBlurRadius", 0.0, 30.0).onChange(function (radius) {
          material.uniforms.uBlurRadius.value = radius;
        });
        gui.add(controls, "uRotation", 0.0, 360.0).onChange(function (angle) {
          material.uniforms.uRotation.value = angle;
        });
        gui.add(controls, "uWidth", 0.0, 1.0).onChange(function (width) {
          material.uniforms.uWidth.value = width;
        }).step(0.1);
        gui.add(controls, "uAmplitude", 0.0, 1.0).onChange(function (amplitude) {
          material.uniforms.uAmplitude.value = amplitude;
        }).step(0.1);
        gui.add(controls, "uVolatility", 0.0, 1.0).onChange(function (volatility) {
          material.uniforms.uVolatility.value = volatility;
        }).step(0.1);
        gui.add(controls, "uSmoothing", 0.0, 5.0).onChange(function (smoothing) {
          material.uniforms.uSmoothing.value = smoothing;
        });
        gui.addColor(controls, "uGlowColor").onChange(function (smoothing) {
          var colorObj = new THREE.Color(controls.uGlowColor);
          var rgba = colorObj.toArray();
          rgba.push(1.0); // Add alpha (not part of gui color picker);
          material.uniforms.uGlowColor.value = rgba;
        });

      });
    </script>
  </body>
</html>
